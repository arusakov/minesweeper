(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],{11:function(e,t,n){e.exports={controls:"controls_controls__3zSnP"}},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),r=n(8),l=n.n(r),o=(n(18),n(2)),s=n(9),c=n(10),u=n(3),f=n(13),m=n(12),h=16,d=288,v=function(e,t){return e<<16|t},p=function(e){return{top:e>>16,left:65535&e}},b=function(e,t){for(var n=new Array(e),i=0;i<e;++i)n[i]=new Array(t);return n},j=function(e,t){for(var n=new Array(e),i=0;i<e;++i)n[i]=new Uint8Array(t);return n},M=function(e,t,n,i,a,r,l){var o=t[n][i],s=e[n][i];return s&&s!==o||(s?(s=s.slice())[r]=s[r].slice():s=j(h,h),e[n]=e[n].slice(),e[n][i]=s),s[r][l]=a,s},w=128,g=function(e,t,n,i,a,r){for(var l=Math.max(0,n-1);l<=Math.min(a.rows-1,n+1);++l)for(var o=Math.floor(l/h),s=l%h,c=Math.max(0,i-1);c<=Math.min(a.columns-1,i+1);++c){var u=Math.floor(c/h),f=c%h,m=e[o][u],d=m?m[s][f]:0;if(!(64&d)){var v=(n!==l||i!==c||r.opened)&&(a.mines-r.mines)/(a.columns*a.rows-r.inited),p=Boolean(v)&&Math.random()<v;if(M(e,t,o,u,64|d|(p?32:0),s,f),p){r.mines+=1;for(var b=Math.max(0,l-1);b<=Math.min(a.rows-1,l+1);++b)for(var j=Math.floor(b/h),w=b%h,g=Math.max(0,c-1);g<=Math.min(a.columns-1,c+1);++g){var T=Math.floor(g/h),O=g%h,x=e[j][T],C=x?x[w][O]:0;M(e,t,j,T,C+1,w,O)}}r.inited+=1}}},T=n(4),O=n.n(T),x=n(0),C=Object(i.memo)((function(e){for(var t=e.tileTop,n=e.tileLeft,i=e.onClick,a=e.onContextMenu,r=e.tile,l=[],o=function(e){for(var o=function(o){var s=r&&r[e][o]||0,c=Boolean(s&w),u=function(e){return e&w?32&e?{className:O.a.mine,content:null}:{content:15&e||null,className:O.a.opened}:{content:null,className:16&e?O.a.flag:""}}(s),f=u.className,m=u.content;l.push(Object(x.jsx)("div",{onClick:c||16&s?void 0:function(){return i(t,n,e,o)},onContextMenu:c?void 0:function(i){i.preventDefault(),a(t,n,e,o)},className:f,style:{top:18*e,left:18*o},children:m},e*h+o))},s=0;s<h;++s)o(s)},s=0;s<h;++s)o(s);return Object(x.jsx)("div",{className:O.a.tile,style:{top:t*d,left:n*d},children:l})})),S=n(6),I=n.n(S),_=n(7),y=n.n(_),R=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(s.a)(this,n),(a=t.call(this,e)).areaRef=Object(i.createRef)(),a.rowTiles=void 0,a.columnTiles=void 0,a.failedTileColumn=0,a.failedTileRow=0,a.queue=new y.a,a.set=new Set,a.tilesSet=new Set,a.intervalId=0,a.mines=0,a.inited=0,a.opened=0,a.flags=0,a.updateTilesSides=function(){if(a.areaRef.current){var e=function(e){var t=e.scrollTop,n=e.scrollLeft,i=e.clientWidth,a=e.clientHeight;return{top:Math.floor(t/d),left:Math.floor(n/d),right:Math.floor((n+i)/d),bottom:Math.floor((t+a)/d)}}(a.areaRef.current);a.setState({tileBottom:Math.min(e.bottom,a.rowTiles-1),tileLeft:e.left,tileRight:Math.min(e.right,a.columnTiles-1),tileTop:e.top})}},a.onCellClick=function(e,t,n,i){if(!a.props.finished){var r=e*h+n,l=t*h+i;a.queue.unshift(v(r,l)),32&a.openEmptyCells()[e][t][n][i]&&(clearInterval(a.intervalId),a.failedTileColumn=t,a.failedTileRow=e,a.queue=new y.a([v(e,t)]),a.intervalId=window.setInterval(a.openMinesCells,200),a.props.onFinish(!1))}},a.openMinesCells=function(){var e=function(e,t,n){for(var i=e.slice(),a=n.queue,r=n.set,l=0;l<32;++l){var o=a.shift();if(null==o)break;r.delete(o);for(var s=p(o),c=s.top,u=s.left,f=i[c][u]||j(h,h),m=0;m<256;++m){var d=Math.floor(m/h),b=m%h;if(!(c*h+d>=t.rows||u*h+b>=t.columns)){var g=f[d][b];if(64&g)32&g&&M(i,i,c,u,g|w,d,b);else{var T=(t.mines-n.mines)/(t.columns*t.rows-n.inited);n.inited+=1;var O=Math.random()<T;n.mines+=O?1:0,M(i,i,c,u,64|g|(O?160:0),d,b)}}}for(var x=Math.abs(c-n.failedTileRow)+Math.abs(u-n.failedTileColumn),C=Math.max(0,c-1);C<=Math.min(n.rowTiles-1,c+1);++C)for(var S=Math.max(0,u-1);S<=Math.min(n.columnTiles-1,u+1);++S)if(!(Math.abs(C-n.failedTileRow)+Math.abs(S-n.failedTileColumn)<=x)){var I=v(C,S);r.has(I)||(a.push(I),r.add(I))}}return i}(a.state.tiles,a.props.gameStatic,Object(u.a)(a));a.setState({tiles:e}),a.queue.length?a.intervalId||(a.intervalId=window.setInterval(a.openMinesCells,200)):clearInterval(a.intervalId)},a.openEmptyCells=function(){var e=a.state.tiles,t=a.props.gameStatic,n=function(e,t,n){for(var i=n.queue,a=n.set,r=e.slice(),l=0;l<512;++l){var o=i.shift();if(null==o)break;a.delete(o);var s=p(o),c=s.top,u=s.left;g(r,e,c,u,t,n);var f=Math.floor(c/h),m=Math.floor(u/h),d=c%h,b=u%h,j=r[f][m][d][b];if(M(r,e,f,m,j|w,d,b),n.opened+=1,!(15&j))for(var T=Math.max(0,c-1);T<=Math.min(t.rows-1,c+1);++T)for(var O=Math.max(0,u-1);O<=Math.min(t.columns-1,u+1);++O)if((T!==c||O!==u)&&!(r[Math.floor(T/h)][Math.floor(O/h)][T%h][O%h]&w)){var x=v(T,O);a.has(x)||(i.push(x),a.add(x))}}return r}(e,t,Object(u.a)(a));return a.queue.length?a.intervalId||(a.intervalId=window.setInterval(a.openEmptyCells,200)):clearInterval(a.intervalId),a.opened+t.mines===t.columns*t.rows&&a.props.onFinish(!0),a.setState({tiles:n}),n},a.onCellFlag=function(e,t,n,i){if(!a.props.finished){var r=a.state.tiles.slice(),l=r[e][t],o=l?l[n][i]:0;!(16&o)&&a.flags>=a.props.gameStatic.mines||(a.flags+=16&o?-1:1,M(r,a.state.tiles,e,t,16^o,n,i),a.setState({tiles:r}))}};var r=e.gameStatic;return a.rowTiles=Math.ceil(r.rows/h),a.columnTiles=Math.ceil(r.columns/h),a.state={tiles:b(a.rowTiles,a.columnTiles),tileTop:0,tileLeft:0,tileRight:-1,tileBottom:-1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.updateTilesSides),this.updateTilesSides()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateTilesSides),clearInterval(this.intervalId)}},{key:"renderTiles",value:function(){for(var e=this.state,t=e.tileBottom,n=e.tileLeft,i=e.tileRight,a=e.tileTop,r=e.tiles,l=[],o=a;o<=t;++o)for(var s=n;s<=i;++s)l.push(Object(x.jsx)(C,{tile:r[o][s],tileLeft:s,tileTop:o,onClick:this.onCellClick,onContextMenu:this.onCellFlag},v(o,s)));return l}},{key:"render",value:function(){var e=this.props.gameStatic;return Object(x.jsx)("div",{className:I.a.area,ref:this.areaRef,onScroll:this.updateTilesSides,children:Object(x.jsx)("div",{className:I.a.container,style:{width:18*e.columns+1,height:18*e.rows+1},children:this.renderTiles()})})}}]),n}(a.a.Component),k=n(11),F=n.n(k),L=function(e){return null==e?"":e?"VICTORY!":"FAIL!"},N=function(e){var t=e.result,n=e.game,a=e.onChange,r=Object(i.useState)(n.rows),l=Object(o.a)(r,2),s=l[0],c=l[1],u=Object(i.useState)(n.columns),f=Object(o.a)(u,2),m=f[0],h=f[1],d=Object(i.useState)(n.mines),v=Object(o.a)(d,2),p=v[0],b=v[1];return Object(x.jsx)("div",{className:F.a.controls,children:Object(x.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a({rows:s,columns:m,mines:p})},children:[Object(x.jsx)("input",{max:1e4,min:1,name:"rows",onChange:function(e){return c(Number(e.currentTarget.value))},type:"number",value:s}),"x",Object(x.jsx)("input",{name:"columns",type:"number",min:1,max:1e4,value:m,onChange:function(e){return h(Number(e.currentTarget.value))}}),Object(x.jsxs)("label",{children:["Bombs:",Object(x.jsx)("input",{name:"mines",type:"number",min:1,max:s*m-1,value:p,onChange:function(e){return b(Number(e.currentTarget.value))}})]}),Object(x.jsxs)("button",{children:[L(t)," Restart!"]})]})})};var q=function(){var e=Object(i.useState)({columns:32,rows:32,mines:240}),t=Object(o.a)(e,2),n=t[0],a=t[1],r=Object(i.useState)(1),l=Object(o.a)(r,2),s=l[0],c=l[1],u=Object(i.useState)(null),f=Object(o.a)(u,2),m=f[0],h=f[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(N,{result:m,game:n,onChange:function(e){a(e),h(null),c((function(e){return e+1}))}}),Object(x.jsx)(R,{finished:null!=m,gameStatic:n,onFinish:h},s)]})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,21)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,r=t.getLCP,l=t.getTTFB;n(e),i(e),a(e),r(e),l(e)}))};l.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(q,{})}),document.getElementById("root")),B()},4:function(e,t,n){e.exports={tile:"Tile_tile__1lsqJ",opened:"Tile_opened__2g0qM",mine:"Tile_mine__FPytn",flag:"Tile_flag__3Dg0B"}},6:function(e,t,n){e.exports={area:"GameArea_area__H0So5",container:"GameArea_container__hLfFA"}}},[[20,1,2]]]);
//# sourceMappingURL=main.fbfb8b81.chunk.js.map